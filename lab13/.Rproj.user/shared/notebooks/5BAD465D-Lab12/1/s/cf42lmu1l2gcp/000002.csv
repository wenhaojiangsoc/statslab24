"0","# Rescale income"
"0","ecls <- ecls %>% mutate(w3income_1k = w3income/1000) # mutate: add new variables"
"0",""
"0","# Fit a logistic regress to generate propensity score using covariates"
"0","# Note we assume that there is no unobserved covariates, which can be a limitation"
"0","# Compared to OLS, the propsensity score relaxes some of the linear assumptions."
"0","m_ps <- glm(catholic ~ race_white + w3income_1k + p5hmage + p5numpla + w3momed_hsb,"
"0","            family = binomial(), data = ecls) "
"0","summary(m_ps)"
"1","
Call:
"
"1",""
"1","glm(formula = catholic ~ race_white + w3income_1k + p5hmage + 
    p5numpla + w3momed_hsb, family = binomial(), data = ecls)"
"1",""
"1","

"
"1","Deviance Residuals: 
"
"1","    Min  "
"1","     1Q  "
"1"," Median  "
"1","     3Q  "
"1","    Max  "
"1","
"
"1","-1.1883  "
"1","-0.6140  "
"1","-0.4508  "
"1","-0.3336  "
"1"," 2.5659  "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","   Estimate"
"1"," Std. Error"
"1"," z value"
"1","             Pr(>|z|)"
"1","    "
"1","
(Intercept)"
"1"," -3.2125519"
"1","  0.2379826"
"1"," -13.499"
"1"," < 0.0000000000000002"
"1"," ***"
"1","
race_white "
"1","  0.3145014"
"1","  0.0700895"
"1","   4.487"
"1","        0.00000721848"
"1"," ***"
"1","
w3income_1k"
"1","  0.0073038"
"1","  0.0006495"
"1","  11.245"
"1"," < 0.0000000000000002"
"1"," ***"
"1","
p5hmage    "
"1","  0.0292168"
"1","  0.0050771"
"1","   5.755"
"1","        0.00000000869"
"1"," ***"
"1","
p5numpla   "
"1"," -0.1439392"
"1","  0.0912255"
"1","  -1.578"
"1","                0.115"
"1","    "
"1","
w3momed_hsb"
"1"," -0.6935868"
"1","  0.0743207"
"1","  -9.332"
"1"," < 0.0000000000000002"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 7701.3  on 9266  degrees of freedom
"
"1",""
"1","Residual deviance: 7168.8  on 9261  degrees of freedom
"
"1","  ("
"1",""
"1","1811 observations deleted due to missingness"
"1",""
"1",")
"
"1","AIC: "
"1",""
"1","7180.8"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","5"
"1",""
"1","
"
"1","
"
"0","# Use above model to generate propensity "
"0","# (the probability of being treated given a set of pre-treatment covariates)"
"0","prs_df <- data.frame(pr_score = predict(m_ps, type = ""response""),"
"0","                     catholic = m_ps$model$catholic)"
"0",""
"0","head(prs_df) %>%"
"0","  kbl(""html"") %>% "
"0","  kable_classic_2(full_width = F)"
