"0",""
"0","# A plotting function that plots the distribution of propensity score of a given covariate"
"0","fn_bal <- function(dta, variable, yname) {"
"0","  dta$variable <- dta[, variable]"
"0","  if (variable == 'w3income') dta$variable <- dta$variable / 10^3"
"0","  dta$catholic <- as.factor(dta$catholic)"
"0","  support <- c(min(dta$variable), max(dta$variable))"
"0","  ggplot(dta, aes(x = distance, y = variable, color = catholic)) +"
"0","    geom_point(alpha = 0.2, size = 1.3) +"
"0","    geom_smooth(method = ""loess"", se = F) +"
"0","    xlab(""Propensity score"") +"
"0","    ylab(yname) +"
"0","    theme_bw() +"
"0","    ylim(support)"
"0","}"
"0",""
"0","# Plot and arrange the plots"
"0","grid.arrange("
"0","  fn_bal(dta_m, ""w3income"", ""Family Income""),"
"0","  fn_bal(dta_m, ""p5numpla"", ""Num Places Lived""),"
"0","  fn_bal(dta_m, ""p5hmage"", ""Mother Age""),"
"0","  fn_bal(dta_m, ""w3momed_hsb"", ""Mom Edu HS or Less""),"
"0","  fn_bal(dta_m, ""race_white"", ""Race is White""),"
"0","  nrow = 3)"
