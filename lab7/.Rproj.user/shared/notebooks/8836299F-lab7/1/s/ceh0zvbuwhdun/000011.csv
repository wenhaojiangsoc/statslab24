"0","set.seed(2023)"
"0",""
"0","## empty results"
"0","homo <- c()"
"0","hetero <- c()"
"0",""
"0","## create x"
"0","X <- rgamma(5000, 5, 4)"
"0",""
"0","for (i in 1:1000){"
"0","  "
"0"," ## create hypothetical data"
"0","  homo_Y <- -0.25 + 1.2*X + rnorm(5000,0,1)"
"0","  hetero_Y <- -0.25 + 1.2*X + rnorm(5000,0,0.5*X)"
"0","  "
"0","  ## data"
"0","  homo_data <- data.frame(X=X,homo_Y)"
"0","  hetero_data <- data.frame(X=X,hetero_Y)"
"0","  "
"0","  ## regression"
"0","  lm1 <- lm(homo_Y ~ X, homo_data)"
"0","  lm2 <- lm(hetero_Y ~ X, hetero_data)"
"0","  "
"0","  ## extract results"
"0","  homo <- c(homo, summary(lm1)$coef[2,1])"
"0","  hetero <- c(hetero, summary(lm2)$coef[2,1])"
"0","}"
"0",""
"0","## combine results"
"0","results <-"
"0","  data.frame(estimate = c(homo,hetero),"
"0","             category = c(rep(""homoskedasticity"",5000),rep(""heteroskedasticity"",5000)))"
"0",""
"0","## plot"
"0","hetero <-"
"0","  results %>%"
"0","  filter(category==""heteroskedasticity"") %>%"
"0","  ggplot(aes(x=estimate)) +"
"0","  geom_histogram(aes(y=..density..),fill=""grey"",color=""black"") +"
"0","  stat_function(fun = dnorm, "
"0","                args = list(mean = 1.2, "
"0","                            sd = summary(lm2)$coef[2,2]),"
"0","                color = ""red3"") +"
"0","  ggtitle(""Estimate under heteroskedasticity"") +"
"0","  theme_bw() +"
"0","  theme(plot.title = element_text(hjust = 0.5))"
"0",""
"0","homo <-"
"0","  results %>%"
"0","  filter(category==""homoskedasticity"") %>%"
"0","  ggplot(aes(x=estimate)) +"
"0","  geom_histogram(aes(y=..density..),fill=""grey"",color=""black"") +"
"0","  stat_function(fun = dnorm, "
"0","                args = list(mean = 1.2, "
"0","                            sd = summary(lm1)$coef[2,2]),"
"0","                color = ""red3"") +"
"0","  ggtitle(""Estimate under Homoskedasticity"") +"
"0","  theme_bw() +"
"0","  theme(plot.title = element_text(hjust = 0.5))"
"0",""
"0","ggarrange(hetero, homo)"
"0",""
